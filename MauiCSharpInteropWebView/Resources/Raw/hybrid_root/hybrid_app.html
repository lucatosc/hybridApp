<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <script>
        function SendToJs(message) {
            Log('Received message from DotNet: ' + message);
        }

        function SendToJsWithArgs(floatValue, message, date) {
            Log('Received message with args from DotNet: floatValue=' + floatValue.toPrecision(2) + ', Message=' + message + ', Seconds=' + (new Date(date).getSeconds()));
        }

        function SendToJsAddNumbers(a, b) {
            var sum = a + b;
            Log('Received message with args from DotNet: SendToJsAddNumbers(' + a + ', ' + b + ') = ' + sum);
            return sum;
        }

        function DoClick() {
            var value = CoolJSLibrary(document.getElementById('valueInput').value);

            SendRawMessageToDotNet(value);
            SendInvokeMessageToDotNet("CallMeFromScript", ["msg from js", 987]);
        }

        function SendRawMessageToDotNet(message) {
            SendMessageToDotNet(0, message);
        }

        function SendInvokeMessageToDotNet(methodName, paramValues) {
            if (typeof paramValues !== 'undefined') {
                if (!Array.isArray(paramValues)) {
                    paramValues = [paramValues];
                }
                for (var i = 0; i < paramValues.length; i++) {
                    paramValues[i] = JSON.stringify(paramValues[i]);
                }
            }

            SendMessageToDotNet(1, JSON.stringify({ "MethodName": methodName, "ParamValues": paramValues }));
        }

        function SendMessageToDotNet(messageType, messageContent) {
            Log('Sending message to DotNet (messageType:' + messageType + '): ' + messageContent);

            var message = JSON.stringify({ "MessageType": messageType, "MessageContent": messageContent });

            if (window.chrome && window.chrome.webview) {
                // Windows WebView2
                window.chrome.webview.postMessage(message);
            }
            else {
                // Android WebView
                hybridWebViewHost.sendMessage(message);
            }
        }

        function Log(message) {
            var logArea = document.getElementById('messageLog');
            logArea.value += '\r\n' + message;

            // Scroll to end
            logArea.selectionStart = logArea.textLength;
            logArea.scrollTop = logArea.scrollHeight;
        }
    </script>
    <script src="js/extra_code.js"></script>
    <link href="styles/my-styles.css" rel="stylesheet" />
</head>
<body>
    <h1>My Hybrid App</h1>
    <div>
        Value from .NET: <input type="text" id="valueInput" value="message from JS" />
    </div>
    <div>
        <button type="button" onclick="DoClick()">Send message to .NET</button>
    </div>
    <div>
        <textarea id="messageLog" style="width: 90%; height: 10em;"></textarea>
    </div>
</body>
</html>